{"version":3,"names":[],"mappings":"","sources":["teamdata.js"],"sourcesContent":["\"use strict\";\n\nfunction updateTeams(teams) {\n  teams.forEach(function (team) {\n    // console.log(element);\n    updateTeamBtn(team.teamkey);\n  });\n}\n\nfunction updateTeamBtn(teamkey) {\n  //console.log('Update ' + teamkey);\n  var row = document.getElementById(\"update-team-\" + teamkey);\n\n  if (row.getElementsByClassName(\"updateBtn\")[0] === undefined) {\n    return;\n  }\n\n  row.getElementsByClassName(\"indicator\")[0].classList.remove(\"show\");\n  row.getElementsByClassName(\"details\")[0].classList.remove(\"show\");\n  row.getElementsByClassName(\"updateBtn\")[0].classList.add(\"spinner\");\n  updateTeamData(teamkey, function (response) {\n    // console.log(response);\n    row.getElementsByClassName(\"updateBtn\")[0].classList.remove(\"spinner\");\n    row.getElementsByClassName(\"date\")[0].innerHTML = response.date;\n    row.getElementsByClassName(\"dateMobile\")[0].innerHTML = response.dateMobile;\n    row.getElementsByClassName(\"updateStatus\")[0].classList.add(\"show\");\n\n    if (response.result.total == true) {\n      row.getElementsByClassName(\"indicator\")[0].classList.add(\"icon-checkmark\", \"show\");\n    } else {\n      row.getElementsByClassName(\"details\")[0].classList.add(\"show\");\n      var classSchedule = response.result.schedule == true ? \"icon-checkmark\" : \"icon-warning\";\n      row.getElementsByClassName(\"schedule\")[0].getElementsByTagName(\"span\")[0].classList.add(classSchedule);\n      var classStandings = response.result.standings == true ? \"icon-checkmark\" : \"icon-warning\";\n      row.getElementsByClassName(\"standings\")[0].getElementsByTagName(\"span\")[0].classList.add(classStandings);\n      var classStandingsDetails = response.result.standingsDetails == true ? \"icon-checkmark\" : \"icon-warning\";\n      row.getElementsByClassName(\"standings-details\")[0].getElementsByTagName(\"span\")[0].classList.add(classStandingsDetails);\n    }\n  });\n}\n\nfunction updateTeamData(teamkey, callback) {\n  // console.log('Loading ' + teamkey);\n  var url = 'index.php?option=com_hbmanager&task=updateTeamData&format=raw';\n  var httpRequest = new XMLHttpRequest();\n\n  if (!httpRequest) {\n    alert('Giving up :( Cannot create an XMLHTTP instance');\n    return false;\n  }\n\n  httpRequest.onreadystatechange = function () {\n    // try {\n    if (httpRequest.readyState === XMLHttpRequest.DONE) {\n      // console.log(httpRequest.status);\n      if (httpRequest.status === 200) {\n        console.log(httpRequest.responseText);\n        var response = JSON.parse(httpRequest.responseText);\n        console.log(response.teamkey + ': ' + response.date); // console.log(response.result);\n\n        callback(response);\n      } else {\n        console.log('There was a problem with the request.');\n        var response = {\n          \"result\": {\n            \"total\": false\n          }\n        }; // console.log(response.result);\n\n        callback(response);\n      }\n    } // }\n    // catch( e ) {\n    // alert('Caught Exception: ' + e.description);\n    // console.log('Caught Exception: ' + e.description);\n    // }\n\n  };\n\n  httpRequest.open('POST', url);\n  httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  httpRequest.send('teamkey=' + encodeURIComponent(teamkey));\n}\n\nfunction updateCheckedTeams() {\n  var checkedBoxes = document.querySelectorAll('input[type=checkbox]:checked'); // console.log(checkedBoxes);\n\n  var teams = [];\n\n  for (var i = 0; i < checkedBoxes.length; i++) {\n    if (checkedBoxes[i].name != \"checkall-toggle\") {\n      var teamkey = checkedBoxes[i].parentElement.parentElement.id;\n      teamkey = teamkey.replace('update-team-', '');\n      teams.push({\n        \"teamkey\": teamkey,\n        \"update\": null\n      }); // teams.push({\"teamkey\": \"M-1\", \"update\": \"2017-10-04 19:37:28\"});\n    }\n  } // console.log(teamkeys);\n\n\n  return updateTeams(teams);\n}\n\nfunction updateAllTeams() {\n  var checkedBoxes = document.querySelectorAll('input[type=checkbox]'); // console.log(checkedBoxes);\n\n  var teams = [];\n\n  for (var i = 0; i < checkedBoxes.length; i++) {\n    if (checkedBoxes[i].name != \"checkall-toggle\") {\n      var teamkey = checkedBoxes[i].parentElement.parentElement.id;\n      teamkey = teamkey.replace('update-team-', '');\n      teams.push({\n        \"teamkey\": teamkey,\n        \"update\": null\n      }); // teams.push({\"teamkey\": \"M-1\", \"update\": \"2017-10-04 19:37:28\"});\n    }\n  } // console.log(teamkeys);\n\n\n  return updateTeams(teams);\n}"],"file":"teamdata.js"}